<h3>{{ctrl.pageHeader}}</h3>
<p>{{ctrl.pageParagraph}}</p>
<form class="form-inline" ng-show="ctrl.isUserResults">
<h4>Upload Results</h4>
<div class="form-group col-m-3">
     <input class="form-contrl btn btn-default" type = "file" file-model = "resultFile"/>
</div>
<div class="checkbox col-m-1">
  <label>
      <input type="checkbox" ng-model="ctrl.isPublic">public
  </label>
</div>
<div class="form-group col-m-3">
     <button class="btn btn-primary" ng-click = "ctrl.uploadFile()">upload result</button>
</div>
<div>
<lable>{{ctrl.uploadState}}</label>
</div>
</form>
<div class="row" style="margin-bottom:24px;"></div>
<div class="result-filters" style="border-top: none;">
    <div class="row podTable" style="vertical-align:middle">
            <div class="col-sm-1 pull-right">
                    <button type="button" class="btn btn-danger" ng-click="ctrl.clearFilters()">
                      <i class="fa fa-search"></i> Clear
                    </button>
            </div>
        <div class="col-sm-1 pull-right">
            <button type="button" class="btn btn-success" ng-click="ctrl.filterList()">
              <i class="fa fa-search"></i> Filter</button>
        </div>
        <div class="col-sm-2 pull-right" ng-class="{'hidden': ctrl.filter=='start_date' || ctrl.filter=='end_date'}">
            <span style="margin-top:6px">Search:&nbsp;&nbsp;</span>
            <input type="text" class="form-control search" style="display:inline;width:105px;padding-left:6px;"
                ng-Model="ctrl.filterText" placeholder="Search String">
        </div>
        <div class="col-sm-3 pull-right" style="width:20%" ng-class="{'hidden': ctrl.filter!='start_date'}">
            <span style="margin-top:6px">Start&nbsp;Date:&nbsp;&nbsp;</span>
            <p class="input-group" style="width:48%;display:inline-flex;">
                <input type="text" class="form-control"
                    uib-datepicker-popup="{{ctrl.format}}"
                    ng-model="ctrl.filterText" is-open="ctrl.startOpen"
                    close-text="Close" />
                <span class="input-group-btn">
                    <button type="button" class="btn btn-default" ng-click="ctrl.open($event, 'startOpen')">
                        <i class="glyphicon glyphicon-calendar"></i>
                    </button>
                </span>
            </p>
        </div>
        <div class="col-sm-3 pull-right" style="width:20%" ng-class="{'hidden': ctrl.filter!='end_date'}">
            <span style="margin-top:6px">End&nbsp;Date:&nbsp;&nbsp;</span>
            <p class="input-group" style="width:48%;display:inline-flex;">
                <input type="text" class="form-control"
                    uib-datepicker-popup="{{ctrl.format}}"
                    ng-model="ctrl.filterText" is-open="ctrl.endOpen"
                    close-text="Close" />
                <span class="input-group-btn">
                    <button type="button" class="btn btn-default" ng-click="ctrl.open($event, 'endOpen')">
                        <i class="glyphicon glyphicon-calendar"></i>
                    </button>
                </span>
            </p>
        </div>
        <div class="col-md-2 row pull-right" style="width: 20%;">
            <span style="margin-top:6px">Filter:&nbsp;&nbsp;</span>
            <select ng-model="ctrl.filter" class="form-control" style="display:inline; width:150px;">
                    <option value="pod" ng-disabled="ctrl.testFilter('pod')" >Pod Name</option>
                    <option value="project" ng-disabled="ctrl.testFilter('project')" >Project Name</option>
                    <option value="case" ng-disabled="ctrl.testFilter('case')">Case Name</option>
                    <option value="installer" ng-disabled="ctrl.testFilter('installer')">Installer</option>
                    <option value="version" ng-disabled="ctrl.testFilter('version')">Version</option>
                    <option value="scenario" ng-disabled="ctrl.testFilter('scenario')">Scenario</option>
                    <option value="build_tag" ng-disabled="ctrl.testFilter('build_tag')">Build Tag</option>
                    <option value="criteria" ng-disabled="ctrl.testFilter('criteria')">Criteria</option>
                    <option value="start_date" ng-disabled="ctrl.testFilter('start_date')">Start Date</option>
                    <option value="end_date" ng-disabled="ctrl.testFilter('end_date')">End Date</option>
            </select>
        </div>

        <div class='filter-box'>
            <div class='filter-tag' ng-repeat="(key, tag) in ctrl.tagArray">
                {{key}}&nbsp:&nbsp{{tag}}
                <div class='delete-tag' ng-click='ctrl.deleteTag(key)'>
                    &times;
                </div>
            </div>
        </div>
    </div>
</div>

<div cg-busy="{promise:ctrl.authRequest,message:'Loading'}"></div>
<div cg-busy="{promise:ctrl.resultsRequest,message:'Loading'}"></div>
<div ng-show="ctrl.data" class="results-table">
    <table ng-data="ctrl.data.result" ng-show="ctrl.data" class="table table-striped table-hover">
        <thead>
            <tr>
                <th>ID</th>
                <th>Pod</th>
                <th>Project</th>
                <th>Test Case</th>
                <th>Installer</th>
                <th>Version</th>
                <th>Scenario</th>
                <th>Criteria</th>
                <th>Build&nbsp;tag</th>
            </tr>
        </thead>

        <tbody>
            <tr ng-repeat-start="(index, result) in ctrl.data.results">
                <td><a ng-click="ctrl.viewResult(result._id)">{{ result._id.substr(-8) }}</a></td>
                <td>{{ result.pod_name }}</td>
                <td>{{ result.project_name }}</td>
                <td>{{ result.case_name }}</td>
                <td>{{ result.installer }}</td>
                <td>{{ result.version }}</td>
                <td>{{ result.scenario }}</td>
                <td>{{ result.criteria }}</td>
                <td>{{ result["build_tag"]}}</td>
            </tr>
            <tr ng-repeat-end=>
            </tr>
        </tbody>
    </table>

    <div class="pages">
        <uib-pagination
            total-items="ctrl.totalItems"
            ng-model="ctrl.currentPage"
            items-per-page="ctrl.itemsPerPage"
            max-size="ctrl.maxSize"
            class="pagination-sm"
            boundary-links="true"
            rotate="false"
            num-pages="ctrl.numPages"
            ng-change="ctrl.filterList()">
        </uib-pagination>
    </div>
</div>

<div ng-show="ctrl.showError" class="alert alert-danger" role="alert">
    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
    <span class="sr-only">Error:</span>
    {{ctrl.error}}
</div>
